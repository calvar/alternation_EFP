\documentclass{article}
\usepackage[ruled,longend]{algorithm2e}

\begin{document}

\SetAlFnt{\rmfamily}
\SetKwSty{textbf}
\SetKwComment{Comment}{/*}{*/}
\SetKwData{KwMat}{Matrix}
\SetKwData{KwDict}{Dict}
\SetKwArray{KwList}{List}
\SetKwFunction{Mod}{Mod}
\SetKw{Null}{null}
\SetKw{Break}{break}
\SetKw{True}{true}
\SetKw{False}{false}
\SetKw{And}{and}


\section{Translator}

\begin{algorithm}[H]
  \DontPrintSemicolon
  \caption{\rmfamily GetStrategy}\label{alg:getstr}
  \KwIn{structure with $N$ rows and $T$ columns storing the pattern $P_{i,j}$=\KwMat{i,j} ($i\in\{0,N-1\}$, $j\in\{0,T-1\}$); agent index $idx$}
  \KwOut{strategy for angent $idx$ $S$=\KwDict{key,action}}
  $N \gets$ number of rows of $P$\;
  $T \gets$ number of columns of $P$\;
  \For{$num\_neigh \gets 1\dots N$}{
    \Comment{all combinations of $num\_neigh$ neighbor indexes}
    $neigh\_lists \gets$ Combinations(\KwList{$0,\dots,(N-1)$},$num\_neigh$)\;
    $sz\gets N!/(num\_neigh!*(N-num\_neigh)!)$\; %%length of $neigh\_lists$\;
    \For{$nlist \gets neigh\_lists[0]\dots neigh\_lists[sz-1]$}{
      \Comment{filter out the pattern rows not in $nlist$}
      $F \gets$ FilterPattern($P,nlist$)\;
      \Comment{check if a valid strategy can be extracted from the filtered pattern}
      $S \gets$GetValidStrategy($F,T,idx$)\;
      \If{$S\neq\ $\Null}{
        \Return $S$\;
      }
    }
  }
  \Return \Null
\end{algorithm}

\begin{algorithm}[H]
  \DontPrintSemicolon
  \caption{\rmfamily FilterPattern}\label{alg:filter}
  \KwIn{pattern $P$=\KwMat{i,j} ($i\in\{0,N-1\}$, $j\in\{0,T-1\}$); neighbor index list $nlist=$ \KwList{$i_0,\dots,i_{r-1}$} ($r\leq N$) } 
  \KwOut{filtred pattern $F$=\KwMat{k,l} ($k\in\{0,r-1\}$, $l\in\{0,T-1\}$)}
  $N \gets$ number of rows of $P$\;
  $T \gets$ number of columns of $P$\;
  $r \gets$ length of $nlist$\;
  $F\gets$ \KwMat{k,l} ($k\in\{0,r-1\}$, $l\in\{0,T-1\})$\;
  \For{$t\gets 0\dots T$}{
    $c\gets 0$\;
    \For{$i\gets nlist[0]\dots nlist[r-1]$}{
      $F_{c,t}\gets P_{i,t}$\;
      $c\gets c+1$\;
    }
  }
  \Return $F$
\end{algorithm}

\begin{algorithm}[H]
  \DontPrintSemicolon
  \caption{\rmfamily GetValidStrategy}\label{alg:validstr}
  \KwIn{pattern $F$; period of the pattern $T$; agent index $idx$}
  \KwOut{strategy for agent $idx$ $S$=\KwDict{string,action}}
  $S \gets$ empty \KwDict{}\;
  \For{$t \gets 0\dots(T-1)$}{
    $key\gets F_{\_,t}$ \Comment{get the $t$'th column of $F$}
    $tmod\gets$ \Mod{$t+1$,$T$}\;
    $action \gets F_{idx,tmod}$\;
    \eIf{$key\in S$}{
      \Comment{check if every key maps to a single action}
      \If{$S[key]\neq action$}{
        \Return \Null\;
      }
    }{
      $S[key]\gets action$
    }
  }
  \Return S
\end{algorithm}


\section{Corrector}

\begin{algorithm}[H]
  \DontPrintSemicolon
  \caption{\rmfamily CorrectState}\label{alg:}
  \KwIn{$in\_cycle$; $is\_down$, $ones$, $curr\_ones$}
  \KwOut{}
  \Comment{If the agent belongs to the cycle an is in down state...}
  \If{$in\_cycle$ \And $is\_down$}{
    \Comment{If the current number of ones in the cycle is less than the expected and the agent's next action is '0'...}
    \uIf{$curr\_ones<ones$ \And $action==0$}{
      \Comment{with 0.5\% probability}
      $rnd$=Rnd()\;
      \If{$rnd<0.5$}{
        $action=1$
      }
    }
    \Comment{If the current number of ones in the cycle is greater than the expected and the agent's next action is '1'...}
    \uElseIf{$curr\_ones>ones$ \And $action==1$}{
      \Comment{with 0.5\% probability}
      $rnd$=Rnd()\;
      \If{$rnd<0.5$}{
        $action=0$
      }
    }
  }
\end{algorithm}
  
\end{document}
